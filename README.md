# üñ• Server Health Telegram Bot

Telegram-–±–æ—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å–µ–º Linux-—Å–µ—Ä–≤–µ—Ä–æ–≤.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤**: CPU, RAM, Swap, Disk, Network
- üîî **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ—Ç—á—ë—Ç—ã**: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏
- üö® **–ê–ª–µ—Ä—Ç—ã**: –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö
- üñ• **–ù–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–æ–≤**: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- üõ† **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –∫–æ–º–∞–Ω–¥—ã –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤, –∫—ç—à–∞ –∏ —Ç.–¥.
- üì± **Telegram**: —É–¥–æ–±–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ –≤ Telegram

1. –û—Ç–∫—Ä—ã—Ç—å [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/newbot`
3. –°–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω

### 2. –£–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID

1. –û—Ç–∫—Ä—ã—Ç—å [@userinfobot](https://t.me/userinfobot)
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/start`
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤–æ–π ID

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã
cd /path/to/server-health-bot

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
chmod +x install.sh
sudo ./install.sh
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nano /opt/server-health-bot/.env

# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å:
# BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_botfather
# ADMIN_ID=–≤–∞—à_telegram_id
```

### 5. –ó–∞–ø—É—Å–∫

```bash
# –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
sudo systemctl enable server-health-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl start server-health-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status server-health-bot
```

### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å

–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –≤ Telegram –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `/start`

---

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python3 -m venv venv
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å BOT_TOKEN –∏ ADMIN_ID

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
python main.py
```

---

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é |
| `/status` | –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ |
| `/check` | –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |
| `/servers` | –°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ |

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/add` | –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä |
| `/remove` | –£–¥–∞–ª–∏—Ç—å —Å–µ—Ä–≤–µ—Ä |

---

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤

### –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä (localhost)

1. `/add` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "‚ûï –î–æ–±–∞–≤–∏—Ç—å"
2. –í–≤–µ—Å—Ç–∏ –∏–º—è: `production` (–∏–ª–∏ –ª—é–±–æ–µ)
3. –í–≤–µ—Å—Ç–∏ —Ö–æ—Å—Ç: `localhost`
4. –ü–æ—Ä—Ç: `/skip` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22)
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `/skip` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é root)

### –î–æ–±–∞–≤–∏—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

**–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å –±–æ—Ç–æ–º):**
```bash
# –°–æ–∑–¥–∞—Ç—å SSH-–∫–ª—é—á (–µ—Å–ª–∏ –Ω–µ—Ç)
ssh-keygen -t ed25519 -C "health-bot"

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
ssh-copy-id user@remote-server.com
```

**–í –±–æ—Ç–µ:**
1. `/add`
2. –ò–º—è: `dev-server`
3. –•–æ—Å—Ç: `192.168.1.100` –∏–ª–∏ `dev.example.com`
4. –ü–æ—Ä—Ç: `22` –∏–ª–∏ –¥—Ä—É–≥–æ–π
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `root` –∏–ª–∏ –¥—Ä—É–≥–æ–π

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```env
# Telegram (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrSTUvwxYZ
ADMIN_ID=123456789

# –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
CHECK_INTERVAL_HOURS=6        # –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ N —á–∞—Å–æ–≤ (0 = –≤—ã–∫–ª)
ALERT_CHECK_INTERVAL_MINUTES=15  # –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤

# –ü–æ—Ä–æ–≥–∏ (–≤ %)
CPU_WARNING=70
CPU_CRITICAL=90
RAM_WARNING=70
RAM_CRITICAL=85
DISK_WARNING=70
DISK_CRITICAL=85
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
server-health-bot/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                    # –°–µ–∫—Ä–µ—Ç—ã (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îî‚îÄ‚îÄ keyboards.py        # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ ssh_manager.py      # SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ health_checker.py   # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îî‚îÄ‚îÄ report_formatter.py # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îî‚îÄ‚îÄ db.py               # SQLite –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ scheduler/
    ‚îî‚îÄ‚îÄ jobs.py             # –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏
```

---

## –õ–æ–≥–∏

```bash
# –õ–æ–≥–∏ –±–æ—Ç–∞
tail -f /var/log/server-health-bot/bot.log

# –õ–æ–≥–∏ systemd
journalctl -u server-health-bot -f
```

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
cd /opt/server-health-bot
sudo systemctl stop server-health-bot

# –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã
git pull  # –∏–ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã

# –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
source venv/bin/activate
pip install -r requirements.txt

sudo systemctl start server-health-bot
```

---

## Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status server-health-bot

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
sudo journalctl -u server-health-bot -n 50
```

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è SSH
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –≤—Ä—É—á–Ω—É—é
ssh -i ~/.ssh/id_rsa user@host "echo OK"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∫–ª—é—á
chmod 600 ~/.ssh/id_rsa
```

### –û—à–∏–±–∫–∞ "ADMIN_ID not configured"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —á–∏—Å–ª–æ–≤–æ–π ID
- –ü–æ–ª—É—á–∏—Ç—å ID –º–æ–∂–Ω–æ —É [@userinfobot](https://t.me/userinfobot)

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- üîê –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ ADMIN_ID
- üîë SSH-–∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å –±–æ—Ç–æ–º
- ‚ö†Ô∏è –û–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- üìù –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
